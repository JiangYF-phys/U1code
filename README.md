code for arXiv:2409.18833
